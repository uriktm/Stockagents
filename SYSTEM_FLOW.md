# ğŸ” ×–×¨×™××ª ×”××¢×¨×›×ª: ×××§×œ×“×ª ×œ××¡×š

## ×¡×§×™×¨×” ×›×œ×œ×™×ª
××¡××š ×–×” ××ª××¨ ××ª ×”××¡×¢ ×”××œ× ×©×œ × ×™×ª×•×— ×× ×™×” ×‘××¢×¨×›×ª Stockagents - ××”×¨×’×¢ ×©×”××©×ª××© ××–×™×Ÿ ×˜×™×§×¨ ×•×¢×“ ×œ×ª×—×–×™×ª ×”××•×¦×’×ª ×‘×××©×§.

---

## ğŸš€ ×–×¨×™××” ××œ××” ×‘×§×¦×¨×”

```
××©×ª××© â†’ Streamlit/Desktop/CLI
    â†“
parse_symbols("AAPL, TSLA") â†’ ['AAPL', 'TSLA']
    â†“
run_stock_analysis(['AAPL', 'TSLA'])
    â†“
create_assistant() â†’ AlphaSynthesizerAgent (GPT-4o-mini)
    â†“
×œ×›×œ ×× ×™×”:
  Thread + Message: "Please analyze AAPL"
    â†“
  Assistant ××¤×¢×™×œ ×›×œ×™×:
    â€¢ NewsAndBuzzTool â†’ ×—×“×©×•×ª + ×¡× ×˜×™×× ×˜
    â€¢ VolumeAndTechnicalsTool â†’ RSI, MACD, Volume
    â€¢ CorporateEventsTool â†’ ×ª××¨×™×›×™ ×¨×•×•×—×™×
    â€¢ AnalystRatingsTool â†’ ×”××œ×¦×•×ª + ××—×™×¨×™ ×™×¢×“
    â†“
  Assistant ××¡× ×ª×–:
    â€¢ ×‘×•×“×§ ×¢×§×‘×™×•×ª ××™× ×“×™×§×˜×•×¨×™×
    â€¢ ××—×©×‘ ×¦×™×•×Ÿ ×‘×™×˜×—×•×Ÿ (1-10)
    â€¢ ××—×–×™×¨ ×ª×—×–×™×ª + ×”×¡×‘×¨ ×¡×™×‘×ª×™
    â†“
×—×™×œ×•×¥: confidence_score + forecast
    â†“
×©××™×¨×ª ×œ×•×’: run_history.log + detailed_analysis.log
    â†“
××™×•×Ÿ ×œ×¤×™ ×¦×™×•×Ÿ ×‘×™×˜×—×•×Ÿ
    â†“
×”×¦×’×” ×‘×××©×§: ×›×¨×˜×™×¡ ×¢× ×ª×—×–×™×ª + × ×ª×•× ×™× ××¤×•×¨×˜×™×
```

---

## ğŸ“‚ ××‘× ×” ×§×‘×¦×™× ××¨×›×–×™

### ×§×‘×¦×™ ×œ×™×‘×”
- **`stockagents/core/analysis.py`** â€“ ×ª×–××•×¨ ×¨××©×™, ×”×¤×¢×œ×ª Assistant
- **`stockagents/assistant/setup.py`** â€“ ×™×¦×™×¨×ª Assistant + System Prompt

### ×›×œ×™ ××™×¡×•×£ × ×ª×•× ×™× (4 ×›×œ×™×)
- **`stockagents/tools/news_and_buzz.py`** â€“ ×—×“×©×•×ª ×-NewsAPI + ×¡× ×˜×™×× ×˜ GPT
- **`stockagents/tools/volume_and_technicals.py`** â€“ RSI, MACD, Volume ×-yfinance
- **`stockagents/tools/corporate_events.py`** â€“ ×ª××¨×™×›×™ ×“×•×—×•×ª ×¨×•×•×—×™×
- **`stockagents/tools/analyst_ratings.py`** â€“ ×”××œ×¦×•×ª ×× ×œ×™×¡×˜×™× + ××—×™×¨×™ ×™×¢×“

### ×××©×§×™×
- **`streamlit_app.py`** â€“ Streamlit Web App
- **`desktop_app.py`** â€“ Qt Desktop App
- **`main.py` + `stockagents/cli/main.py`** â€“ CLI

---

## ğŸ› ï¸ ×”×›×œ×™× ×‘×¤×™×¨×•×˜

### ğŸ”¹ NewsAndBuzzTool
**××§×•×¨:** NewsAPI.org (Bloomberg, Reuters, CNBC, WSJ, MarketWatch, Fool, SeekingAlpha, Benzinga, Yahoo)

**×ª×”×œ×™×š:**
1. ××•×©×š ×©× ×—×‘×¨×” ×-yfinance
2. ×‘×•× ×” ×©××™×œ×ª×ª ×—×™×¤×•×© (×˜×™×§×¨ + ×©× ××œ× + ×©× ××§×•×¦×¨)
3. ××•×©×š ×¢×“ 15 ×›×ª×‘×•×ª ××”××§×•×¨×•×ª
4. ××¡× ×Ÿ ×¨×œ×•×•× ×˜×™×•×ª
5. ×©×•×œ×— ×›×•×ª×¨×•×ª ×œ-GPT-4o-mini ×œ× ×™×ª×•×— ×¡× ×˜×™×× ×˜
6. ××—×–×™×¨: `sentiment_score` (-1 ×œ-1), `narrative`, `buzz_factor`, `strength` (0-1)

**×¤×œ×˜ ×œ×“×•×’××”:**
```python
{
  "sentiment_score": 0.65,
  "narrative": "Positive outlook driven by strong earnings...",
  "buzz_factor": 3.75,
  "strength": 0.82,
  "top_headlines": [...],
  "article_links": [...]
}
```

---

### ğŸ”¹ VolumeAndTechnicalsTool
**××§×•×¨:** yfinance (3 ×—×•×“×©×™ × ×ª×•× ×™× ×”×™×¡×˜×•×¨×™×™×)

**×ª×”×œ×™×š:**
1. ××—×©×‘ **RSI (14 ×ª×§×•×¤×•×ª)**: ×¢×•×§×‘ ×¨×•×•×—×™×/×”×¤×¡×“×™× ×™×•××™×™×, ×× ×¨××œ ×œ-0-100
2. ××—×©×‘ **MACD**: MACD Line (EMA 12-26), Signal Line (EMA 9)
3. ××–×”×” **Crossover**: ×”×× MACD ×—×¦×” Signal ×‘×™×Ÿ ××ª××•×œ ×œ×”×™×•×
4. ××—×©×‘ **Volume Spike**: × ×¤×— ××—×¨×•×Ÿ / ×××•×¦×¢ 20 ×™××™×
5. **×–×™×”×•×™ ××•×˜×•××˜×™ ×™×•× ×œ× ××œ×**: ×× × ×¤×— < 10% ×××•×¦×¢, ×œ×•×§×— ×™×•× ×§×•×“×
6. ××—×–×™×¨: `rsi`, `macd_signal_status`, `volume_spike_ratio`, `technical_signal`, `strength`

**×¤×œ×˜ ×œ×“×•×’××”:**
```python
{
  "volume_spike_ratio": 2.3,
  "rsi": 58.42,
  "macd_signal_status": "Crossover",
  "technical_signal": "Bullish Momentum (MACD Crossover)",
  "strength": 0.76
}
```

---

### ğŸ”¹ CorporateEventsTool
**××§×•×¨:** yfinance

**×ª×”×œ×™×š:**
1. ××•×©×š ×ª××¨×™×›×™ ×“×•×—×•×ª ×¨×•×•×—×™×
2. ××¡× ×Ÿ ×ª××¨×™×›×™× ×¢×ª×™×“×™×™×
3. ××—×–×™×¨ ×”×ª××¨×™×š ×”×§×¨×•×‘ ×‘×™×•×ª×¨

**×¤×œ×˜ ×œ×“×•×’××”:**
```python
{
  "upcoming_earnings_date": "2025-11-05",
  "has_upcoming_event": True
}
```

---

### ğŸ”¹ AnalystRatingsTool
**××§×•×¨:** yfinance

**×ª×”×œ×™×š:**
1. ××•×©×š ×”××œ×¦×•×ª ×× ×œ×™×¡×˜×™× (Strong Buy, Buy, Hold, Sell, Strong Sell)
2. ××•×©×š ××—×™×¨×™ ×™×¢×“ (mean, median, high, low)
3. ××•×©×š 5 ×¤×¢×•×œ×•×ª ××—×¨×•× ×•×ª (upgrades/downgrades)
4. ××•×©×š ××—×™×¨ × ×•×›×—×™
5. ××—×©×‘ ×©×™× ×•×™ ×¦×¤×•×™ ×‘××—×•×–×™×
6. ××—×©×‘ ×¦×™×•×Ÿ ×§×•× ×¦× ×–×•×¡ ××©×•×§×œ×œ (1-5)

**×¤×œ×˜ ×œ×“×•×’××”:**
```python
{
  "consensus_rating": "Buy",
  "consensus_score": 3.94,
  "rating_distribution": {"strong_buy": 5, "buy": 7, "hold": 4, "sell": 1, "strong_sell": 0},
  "mean_target_price": 125.0,
  "latest_price": 110.0,
  "target_price_change": 15.0,
  "target_price_change_pct": 13.64,
  "recent_actions": [...]
}
```

---

## ğŸ§  ×¡×™× ×ª×–×” â€“ ××™×š Assistant ××—×œ×™×˜?

### ×¢×§×¨×•× ×•×ª ×”× ×™×ª×•×— (××ª×•×š System Prompt)
1. **× ×™×ª×•×— ××•×‘×™×™×§×˜×™×‘×™** â€“ ×œ× ×©××¨× ×™ ××• ××•×¤×˜×™××™ ××“×™
2. **×‘×¡×™×¡ ×¢×œ × ×ª×•× ×™× ×‘×œ×‘×“** â€“ ×œ× ×¢×œ ×”× ×—×•×ª
3. **×©×§×™×¤×•×ª ×‘× ×ª×•× ×™× ××¢×•×¨×‘×™×** â€“ ×× ×™×© ×’×•×¨××™× ×—×™×•×‘×™×™× ×•×©×œ×™×œ×™×™×, ×œ×¦×™×™×Ÿ ×–××ª

### ×”×¦×œ×‘×•×ª ×•×‘×“×™×§×•×ª
#### âœ… ×‘×™×˜×—×•×Ÿ ×’×‘×•×” (8-10):
- sentiment ×—×™×•×‘×™ (>0.5) **+** MACD Crossover ×—×™×•×‘×™ **+** RSI ×‘×˜×•×•×— ×‘×¨×™× (30-70)
- ×œ×¤×—×•×ª **×©× ×™ ××™× ×“×™×§×˜×•×¨×™× ×—×–×§×™×** (`strength >= 0.7`) ×‘××•×ª×• ×›×™×•×•×Ÿ
- × ×¤×— ××¡×—×¨ ×’×‘×•×” (>2x) + ×¡× ×˜×™×× ×˜ ×¢×§×‘×™

#### âš ï¸ ×‘×™×˜×—×•×Ÿ ×‘×™× ×•× ×™ (5-7):
- sentiment ×—×™×•×‘×™ **××š** RSI > 75 (×¡×™×›×•×Ÿ ×œ×ª×™×§×•×Ÿ)
- MACD ×—×™×•×‘×™ **××š** × ×¤×— × ××•×š (0.7x)
- ××™× ×“×™×§×˜×•×¨×™× ×× ×•×’×“×™× ×—×œ×§×™×ª

#### âŒ ×‘×™×˜×—×•×Ÿ × ××•×š (1-4):
- × ×ª×•× ×™× ×¡×•×ª×¨×™× ×‘×—×•×–×§×”
- ×—×¡×¨ ××™×“×¢ ×—×“×©×•×ª×™
- ×›×œ ×”××™× ×“×™×§×˜×•×¨×™× ×× ×•×’×“×™×

### ×©×“×” `strength` (0-1)
×›×œ ×›×œ×™ ××—×–×™×¨ `strength` ×©××¦×™×™×Ÿ ×¢×•×¦××ª ×”××•×ª:
- **`strength >= 0.7`** â†’ ××•×ª ×—×–×§
- **`strength <= 0.3`** â†’ ××•×ª ×—×œ×©
- **Assistant ××©×ª××© ×‘-strength** ×œ×§×‘×™×¢×ª ×¢×§×‘×™×•×ª

### ×›×œ×œ×™ RSI ××™×•×—×“×™×
- **RSI > 75**: ×¡×™×›×•×Ÿ ×’×‘×•×” ×œ×ª×™×§×•×Ÿ â€“ ×–×”×™×¨×•×ª ×¢× ×ª×—×–×™×•×ª ×—×™×•×‘×™×•×ª
- **RSI < 25**: ×¡×™×›×•×Ÿ ×œ×”××©×š ×™×¨×™×“×”
- **30 < RSI < 70**: ×˜×•×•×— ×‘×¨×™× ×œ××’××•×ª

---

## ğŸ“Š ×—×™×œ×•×¥ ×•×¢×™×‘×•×“ ×ª×•×¦××•×ª

### ×¤×•× ×§×¦×™×•×ª ×—×™×œ×•×¥ (`stockagents/core/analysis.py`)
1. **`_render_assistant_response(messages)`** â€“ ×—×•×œ×¥ ×”×•×“×¢×ª Assistant ×-Thread
2. **`_extract_confidence_score(response)`** â€“ ××—×¤×© ×ª×‘× ×™×•×ª:
   - `"confidence score: 8/10"`
   - `"×¦×™×•×Ÿ ×‘×™×˜×—×•×Ÿ: 9/10"`
   - `"8/10"`
3. **`_extract_forecast(response)`** â€“ ××—×¤×©:
   - `"×ª×—×–×™×ª:"` / `"Forecast:"`
   - ××™×œ×•×ª ××¤×ª×—: "×¦×¤×•×™", "×¢×œ×™×™×”", "×™×¨×™×“×”", "bullish", "bearish"
4. **`_collect_tool_insights(symbol)`** â€“ ××¨×™×¥ ×©×•×‘ ××ª ×”×›×œ×™× ×œ×¦×•×¨×š ×”×¦×’×” ×‘×××©×§

### ×“×•×’××ª ×¤×œ×˜ Assistant
```
×ª×—×–×™×ª: ×¦×¤×•×™×” ×¢×œ×™×™×” ×‘××—×™×¨ ×‘×’×œ×œ × ×¤×— ××¡×—×¨ ×’×‘×•×” ×‘-200% ×•×—×“×©×•×ª ×—×™×•×‘×™×•×ª

×¦×™×•×Ÿ ×‘×™×˜×—×•×Ÿ: 9/10 - ×›×œ ×”××™× ×“×™×§×˜×•×¨×™× ×—×™×•×‘×™×™× ×•×¢×§×‘×™×™×

×”×¡×‘×¨ ×¡×™×‘×ª×™:
â€¢ × ×¤×— ××¡×—×¨ ×’×‘×•×” ×‘-200% ××”×××•×¦×¢
â€¢ MACD Crossover ×—×™×•×‘×™
â€¢ RSI ×‘×˜×•×•×— ×‘×¨×™× (58)
â€¢ ×¡× ×˜×™×× ×˜ ×—×“×©×•×ª×™ ×—×™×•×‘×™ ×××•×“ (0.65) ×¢× 15 ×›×ª×‘×•×ª ×‘-24 ×©×¢×•×ª
â€¢ ×”××œ×¦×•×ª ×× ×œ×™×¡×˜×™×: Buy (×¦×™×•×Ÿ 3.94/5)
â€¢ ××—×™×¨ ×™×¢×“ ×××•×¦×¢ 13.6% ××¢×œ ×”××—×™×¨ ×”× ×•×›×—×™
```

---

## ğŸ’¾ ×œ×•×’×™×

### `logs/run_history.log`
×¡×™×›×•× ×›×œ ×¨×™×¦×”:
```
=== Stock Analysis Run ===
Run Date: 2025-10-20T19:45:23+03:00
- Stock: AAPL
- Forecast: ×¦×¤×•×™×” ×¢×œ×™×™×” ×‘××—×™×¨ ×‘×’×œ×œ × ×¤×— ××¡×—×¨ ×’×‘×•×” ×‘-200% ×•×—×“×©×•×ª ×—×™×•×‘×™×•×ª
- Confidence: 9.00
```

### `logs/detailed_analysis.log`
×œ×•×’×™× ××¤×•×¨×˜×™× (DEBUG level) ××›×œ ×›×œ×™:
```
2025-10-20 19:45:10 - stockagents.tools.volume_and_technicals - INFO - 
Technical analysis for AAPL: RSI=58.42, Volume Ratio=2.30, 
Signal=Bullish Momentum (MACD Crossover), MACD Status=Crossover, Strength=0.76
```

---

## ğŸ–¥ï¸ ×”×¦×’×” ×‘×××©×§

### ××‘× ×” ×ª×•×¦××”
```python
{
  "symbol": "AAPL",
  "forecast": "×¦×¤×•×™×” ×¢×œ×™×™×”...",
  "confidence_score": 9.0,
  "response_text": "...",
  "tool_insights": {
    "news": {...},
    "technicals": {...},
    "events": {...}
  }
}
```

### ×¨×›×™×‘×™ ×”×¦×’×” (Streamlit)
- **×ª×—×–×™×ª** (××•×“×’×©×ª)
- **×¦×™×•×Ÿ ×‘×™×˜×—×•×Ÿ** (×™×¨×•×§ 8+, ×¦×”×•×‘ 5-7, ××“×•× <5)
- **×¤×™×¨×•×˜ ×¡×™×‘×ª×™** (× ×§×•×“×•×ª ×ª×‘×œ×™×˜)
- **×§×™×©×•×¨×™× ×œ×›×ª×‘×•×ª** (clickable)
- **× ×ª×•× ×™× ×˜×›× ×™×™×** (RSI, MACD, Volume)
- **×ª××¨×™×š ×“×•×— ×¨×•×•×—×™×**
- **×”××œ×¦×•×ª ×× ×œ×™×¡×˜×™×**

---

## ğŸ”¬ ×‘×“×™×§×•×ª

### ×‘×“×™×§×•×ª ×™×—×™×“×”
- `tests/test_analyst_ratings_tool.py`
- `tests/test_social_sentiment_tool.py`
- `tests/test_history.py`
- ××©×ª××©×•×ª ×‘-**monkeypatch** ×œ×“××•×ª API calls

### ×‘×“×™×§×•×ª ××™× ×˜×’×¨×¦×™×”
- `tests/test_social_sentiment_integration.py`
- ×¨×¦×•×ª ×¨×§ ×¢× credentials ×××™×ª×™×™×
- ××“×œ×’×•×ª ××•×˜×•××˜×™×ª (`pytest.skip`) ×× ××™×Ÿ API keys

### ×”×¨×¦×”
```bash
# ××•×˜×•××˜×™ ×¢× ×“×•×—×•×ª
.\scripts\run_tests.ps1

# ×™×“× ×™
.\.venv\Scripts\python -m pytest
```

---

## ğŸ“ × ×§×•×“×•×ª ××¤×ª×—

### API Keys × ×“×¨×©×™× (`.env`)
- `OPENAI_API_KEY` â€“ GPT-4o-mini ×œ×¡× ×˜×™×× ×˜ ×•×œ-Assistant
- `NEWSAPI_API_KEY` â€“ NewsAPI.org
- `X_BEARER_TOKEN` (××•×¤×¦×™×•× ×œ×™) â€“ Twitter/X sentiment
- `SERPAPI_API_KEY` (××•×¤×¦×™×•× ×œ×™) â€“ ×’×™×‘×•×™ ×œ-Twitter

### ××§×•×¨×•×ª × ×ª×•× ×™×
- **NewsAPI.org** â€“ ×—×“×©×•×ª ×¤×™× × ×¡×™×•×ª
- **yfinance** â€“ × ×ª×•× ×™× ×˜×›× ×™×™×, ×¨×•×•×—×™×, ×× ×œ×™×¡×˜×™×
- **OpenAI GPT-4o-mini** â€“ × ×™×ª×•×— ×¡× ×˜×™×× ×˜, ×¡×™× ×ª×–×”

### ×ª×¤×§×™×“ ×”-Assistant
**AlphaSynthesizerAgent** ×”×•× ×× ×œ×™×¡×˜ ×‘×›×™×¨ ×©××—×œ×™×˜:
- ××™×œ×• ×›×œ×™× ×œ×”×¤×¢×™×œ
- ××™×š ×œ×©×§×œ×œ × ×ª×•× ×™×
- ××” ×¨××ª ×”×‘×™×˜×—×•×Ÿ
- ××” ×”×ª×—×–×™×ª ×”×¡×•×¤×™×ª

---

## ğŸ“– ××¡××›×™× × ×•×¡×¤×™×
- `AGENTS.md` â€“ ××¤×¨×˜ Agent
- `PROJECT_PLAN.md` â€“ ×ª×•×›× ×™×ª ×¤×¨×•×™×§×˜
- `tests/README.md` â€“ ××“×¨×™×š ×‘×“×™×§×•×ª
- `SETUP_GUIDE.md` â€“ ×”×•×¨××•×ª ×”×ª×§× ×”
